{"remainingRequest":"/Users/xuewei/Desktop/开源项目/arcade-x6/node_modules/babel-loader/lib/index.js!/Users/xuewei/Desktop/开源项目/arcade-x6/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/xuewei/Desktop/开源项目/arcade-x6/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/xuewei/Desktop/开源项目/arcade-x6/src/views/tools/ToolDetailRecord.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/xuewei/Desktop/开源项目/arcade-x6/src/views/tools/ToolDetailRecord.vue","mtime":1684825793598},{"path":"/Users/xuewei/Desktop/开源项目/arcade-x6/babel.config.js","mtime":1667046646049},{"path":"/Users/xuewei/Desktop/开源项目/arcade-x6/node_modules/cache-loader/dist/cjs.js","mtime":1689430340827},{"path":"/Users/xuewei/Desktop/开源项目/arcade-x6/node_modules/babel-loader/lib/index.js","mtime":1689430342224},{"path":"/Users/xuewei/Desktop/开源项目/arcade-x6/node_modules/cache-loader/dist/cjs.js","mtime":1689430340827},{"path":"/Users/xuewei/Desktop/开源项目/arcade-x6/node_modules/vue-loader-v16/dist/index.js","mtime":1689430342169}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgQ29kZW1pcnJvciB9IGZyb20gInZ1ZS1jb2RlbWlycm9yIjsKaW1wb3J0IHsgcmVmIH0gZnJvbSAidnVlIjsKaW1wb3J0IHsganNvbiB9IGZyb20gIkBjb2RlbWlycm9yL2xhbmctanNvbiI7CmltcG9ydCB7IG9uZURhcmsgfSBmcm9tICJAY29kZW1pcnJvci90aGVtZS1vbmUtZGFyayI7CmltcG9ydCB7IGdldExvZyB9IGZyb20gIkAvYXBpL3JlcXVlc3QiOwppbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICJ2dWUtcm91dGVyIjsKCi8vIOW8ueWHuueahG1vZGFsCmNvbnN0IHVzZU1vZGFsRWZmZWN0ID0gKCkgPT4gewogIGNvbnN0IHZpc2libGUgPSByZWYoZmFsc2UpOwogIGNvbnN0IHJlcUNvZGUgPSByZWYoJycpOwogIGNvbnN0IHJlc0NvZGUgPSByZWYoJycpOwogIGNvbnN0IHNob3dSZXFBbmRSZXMgPSBpdGVtID0+IHsKICAgIHZpc2libGUudmFsdWUgPSB0cnVlOwogICAgcmVxQ29kZS52YWx1ZSA9IGl0ZW0ucmVxdWVzdFBhcmFtID8gSlNPTi5zdHJpbmdpZnkoSlNPTi5wYXJzZShpdGVtLnJlcXVlc3RQYXJhbSksIG51bGwsIDIpIDogJyc7CiAgICByZXNDb2RlLnZhbHVlID0gaXRlbS5yZXNwb25zZVBhcmFtID8gSlNPTi5zdHJpbmdpZnkoSlNPTi5wYXJzZShpdGVtLnJlc3BvbnNlUGFyYW0pLCBudWxsLCAyKSA6ICcnOwogIH07CiAgY29uc3QgaGFuZGxlQ2FuY2VsID0gKCkgPT4gewogICAgdmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgcmVxQ29kZS52YWx1ZSA9ICcnOwogICAgcmVzQ29kZS52YWx1ZSA9ICcnOwogIH07CiAgY29uc3QgZXh0ZW5zaW9uc1JlcSA9IFtqc29uKCldOwogIGNvbnN0IGV4dGVuc2lvbnNSZXMgPSBbanNvbigpLCBvbmVEYXJrXTsKICByZXR1cm4gewogICAgdmlzaWJsZSwKICAgIHJlcUNvZGUsCiAgICByZXNDb2RlLAogICAgc2hvd1JlcUFuZFJlcywKICAgIGhhbmRsZUNhbmNlbCwKICAgIGV4dGVuc2lvbnNSZXEsCiAgICBleHRlbnNpb25zUmVzCiAgfTsKfTsKCi8vIOiOt+WPluaXpeW/lwpjb25zdCB1c2VMb2dFZmZlY3QgPSAoKSA9PiB7CiAgY29uc3QgdGltZUxpbmVMaXN0ID0gcmVmKFtdKTsKICBjb25zdCBnZXRMb2dzID0gYXN5bmMgaWQgPT4gewogICAgbGV0IHJlcSA9IHsKICAgICAgdG9vbElkOiBpZAogICAgfTsKICAgIGF3YWl0IGdldExvZyhyZXEpLnRoZW4ocmVzID0+IHsKICAgICAgdmFyIF9yZXMkZGF0YTsKICAgICAgaWYgKHJlcy5jb2RlID09PSAwICYmIChfcmVzJGRhdGEgPSByZXMuZGF0YSkgIT09IG51bGwgJiYgX3JlcyRkYXRhICE9PSB2b2lkIDAgJiYgX3JlcyRkYXRhLnRlc3RUb29sUnVuUmVjb3JkLmxlbmd0aCkgewogICAgICAgIHRpbWVMaW5lTGlzdC52YWx1ZSA9IHJlcy5kYXRhLnRlc3RUb29sUnVuUmVjb3JkOwogICAgICB9CiAgICB9KTsKICB9OwogIHJldHVybiB7CiAgICB0aW1lTGluZUxpc3QsCiAgICBnZXRMb2dzCiAgfTsKfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJUb29sRGV0YWlsUmVjb3JkIiwKICBjb21wb25lbnRzOiB7CiAgICBDb2RlbWlycm9yCiAgfSwKICBzZXR1cCgpIHsKICAgIGNvbnN0IHsKICAgICAgdmlzaWJsZSwKICAgICAgcmVxQ29kZSwKICAgICAgcmVzQ29kZSwKICAgICAgZXh0ZW5zaW9uc1JlcSwKICAgICAgZXh0ZW5zaW9uc1JlcywKICAgICAgc2hvd1JlcUFuZFJlcywKICAgICAgaGFuZGxlQ2FuY2VsCiAgICB9ID0gdXNlTW9kYWxFZmZlY3QoKTsKICAgIGNvbnN0IHsKICAgICAgdGltZUxpbmVMaXN0LAogICAgICBnZXRMb2dzCiAgICB9ID0gdXNlTG9nRWZmZWN0KCk7CiAgICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTsKICAgIGdldExvZ3Mocm91dGVyLmN1cnJlbnRSb3V0ZS52YWx1ZS5wYXJhbXMuaWQpOwogICAgcmV0dXJuIHsKICAgICAgdGltZUxpbmVMaXN0LAogICAgICB2aXNpYmxlLAogICAgICByZXFDb2RlLAogICAgICByZXNDb2RlLAogICAgICBleHRlbnNpb25zUmVxLAogICAgICBleHRlbnNpb25zUmVzLAogICAgICBzaG93UmVxQW5kUmVzLAogICAgICBoYW5kbGVDYW5jZWwKICAgIH07CiAgfQp9Ow=="},{"version":3,"mappings":"AAiDA,SAAQA,UAAU,QAAO,gBAAgB;AACzC,SAAQC,GAAG,QAAO,KAAK;AACvB,SAAQC,IAAI,QAAO,uBAAuB;AAC1C,SAAQC,OAAO,QAAO,4BAA4B;AAClD,SAAQC,MAAM,QAAO,eAAe;AACpC,SAAQC,SAAS,QAAO,YAAY;;AAEpC;AACA,MAAMC,cAAa,GAAI,MAAM;EAC3B,MAAMC,OAAM,GAAIN,GAAG,CAAC,KAAK,CAAC;EAC1B,MAAMO,OAAM,GAAIP,GAAG,CAAC,EAAE;EACtB,MAAMQ,OAAM,GAAIR,GAAG,CAAC,EAAE;EACtB,MAAMS,aAAY,GAAKC,IAAI,IAAG;IAC5BJ,OAAO,CAACK,KAAI,GAAI,IAAG;IACnBJ,OAAO,CAACI,KAAI,GAAID,IAAI,CAACE,YAAY,GAACC,IAAI,CAACC,SAAS,CAACD,IAAI,CAACE,KAAK,CAACL,IAAI,CAACE,YAAY,CAAC,EAAC,IAAI,EAAC,CAAC,CAAC,GAAC,EAAC;IACxFJ,OAAO,CAACG,KAAI,GAAID,IAAI,CAACM,aAAa,GAACH,IAAI,CAACC,SAAS,CAACD,IAAI,CAACE,KAAK,CAACL,IAAI,CAACM,aAAa,CAAC,EAAC,IAAI,EAAC,CAAC,CAAC,GAAC,EAAC;EAC5F;EACA,MAAMC,YAAW,GAAI,MAAI;IACvBX,OAAO,CAACK,KAAI,GAAI,KAAI;IACpBJ,OAAO,CAACI,KAAI,GAAI,EAAC;IACjBH,OAAO,CAACG,KAAI,GAAI,EAAC;EACnB;EACA,MAAMO,aAAY,GAAI,CAACjB,IAAI,EAAE;EAC7B,MAAMkB,aAAY,GAAI,CAAClB,IAAI,EAAE,EAACC,OAAO;EACrC,OAAO;IACLI,OAAO;IACPC,OAAO;IACPC,OAAO;IACPC,aAAa;IACbQ,YAAY;IACZC,aAAa;IACbC;EACF;AACF;;AAEA;AACA,MAAMC,YAAW,GAAI,MAAI;EACvB,MAAMC,YAAW,GAAIrB,GAAG,CAAC,EAAE;EAC3B,MAAMsB,OAAM,GAAI,MAAOC,EAAE,IAAG;IAC1B,IAAIC,GAAE,GAAI;MAACC,MAAM,EAAEF;IAAE;IACrB,MAAMpB,MAAM,CAACqB,GAAG,CAAC,CAACE,IAAI,CAACC,GAAG,IAAE;MAAA;MAC1B,IAAIA,GAAG,CAACC,IAAG,KAAM,kBAAKD,GAAG,CAACE,IAAI,sCAAR,UAAUC,iBAAiB,CAACC,MAAM,EAAC;QACvDV,YAAY,CAACV,KAAI,GAAIgB,GAAG,CAACE,IAAI,CAACC,iBAAgB;MAChD;IACF,CAAC;EACH;EACA,OAAO;IACLT,YAAY;IAACC;EACf;AACF;AAEA,eAAe;EACbU,IAAI,EAAE,kBAAkB;EACxBC,UAAU,EAAE;IAAClC;EAAU,CAAC;EACxBmC,KAAK,GAAG;IACN,MAAM;MAAE5B,OAAO;MAAEC,OAAO;MAAEC,OAAO;MAAEU,aAAa;MAAEC,aAAa;MAAEV,aAAa;MAAEQ;IAAa,IAAIZ,cAAc,EAAC;IAChH,MAAM;MAAEgB,YAAY;MAACC;IAAQ,IAAIF,YAAY,EAAC;IAC9C,MAAMe,MAAK,GAAI/B,SAAS,EAAC;IACzBkB,OAAO,CAACa,MAAM,CAACC,YAAY,CAACzB,KAAK,CAAC0B,MAAM,CAACd,EAAE;IAC3C,OAAO;MACLF,YAAY;MAACf,OAAO;MAAEC,OAAO;MAAEC,OAAO;MAAEU,aAAa;MAAEC,aAAa;MAAEV,aAAa;MAAEQ;IACvF;EACF;AACF","names":["Codemirror","ref","json","oneDark","getLog","useRouter","useModalEffect","visible","reqCode","resCode","showReqAndRes","item","value","requestParam","JSON","stringify","parse","responseParam","handleCancel","extensionsReq","extensionsRes","useLogEffect","timeLineList","getLogs","id","req","toolId","then","res","code","data","testToolRunRecord","length","name","components","setup","router","currentRoute","params"],"sourceRoot":"","sources":["/Users/xuewei/Desktop/开源项目/arcade-x6/src/views/tools/ToolDetailRecord.vue"],"sourcesContent":["<template>\n  <div style=\"width: 100%;height: 100%;background: #fff\" class=\"tool-detail-record\">\n    <a-timeline class=\"timeline—group\" v-if=\"timeLineList.length\">\n      <a-timeline-item v-for=\"(item,index) of timeLineList\" :key=\"index\">\n        <p>\n          <span>{{item.operator+'\\n'+$moment(item.createTime).format('YYYY-MM-DD HH:mm:ss')+'\\n'}}</span>\n          <a @click=\"showReqAndRes(item)\">请求参数&响应参数</a>\n        </p>\n      </a-timeline-item>\n    </a-timeline>\n    <div v-else class=\"system-no-content\">\n      <img src=\"@/assets/images/noDataDefault.svg\" class=\"system-no-content-image\"><br/>\n      <span class=\"system-no-content-text\">暂无运行记录</span>\n    </div>\n    <a-modal v-model:visible=\"visible\" title=\"请求参数&响应参数\"\n             :footer=\"null\"\n             width=\"100%\"\n             wrap-class-name=\"full-params-modal\"\n             :destroyOnClose=true\n             @cancel=\"handleCancel\"\n    >\n      <div style=\"width: 100%;display: flex\">\n        <div class=\"record-req-left\">\n          <a-button type=\"primary\" ghost>请求报文</a-button>\n          <codemirror\n              v-model=\"reqCode\"\n              :style=\"{ width: '100%', height: '100%' }\"\n              :autofocus=\"true\"\n              :indent-with-tab=\"true\"\n              :tabSize=\"2\"\n              :extensions=\"extensionsReq\"/>\n        </div>\n        <div class=\"record-res-right\">\n          <a-button type=\"primary\" ghost>返回报文</a-button>\n          <codemirror\n              v-model=\"resCode\"\n              :style=\"{ width: '100%', height: '100%' }\"\n              :autofocus=\"true\"\n              :indent-with-tab=\"true\"\n              :tabSize=\"2\"\n              :extensions=\"extensionsRes\"\n          />\n        </div>\n      </div>\n    </a-modal>\n  </div>\n</template>\n\n<script>\nimport {Codemirror} from \"vue-codemirror\";\nimport {ref} from \"vue\";\nimport {json} from \"@codemirror/lang-json\";\nimport {oneDark} from \"@codemirror/theme-one-dark\";\nimport {getLog} from \"@/api/request\";\nimport {useRouter} from \"vue-router\";\n\n// 弹出的modal\nconst useModalEffect = () => {\n  const visible = ref(false);\n  const reqCode = ref('')\n  const resCode = ref('')\n  const showReqAndRes = (item)=>{\n    visible.value = true\n    reqCode.value = item.requestParam?JSON.stringify(JSON.parse(item.requestParam),null,2):''\n    resCode.value = item.responseParam?JSON.stringify(JSON.parse(item.responseParam),null,2):''\n  }\n  const handleCancel = ()=>{\n    visible.value = false\n    reqCode.value = ''\n    resCode.value = ''\n  }\n  const extensionsReq = [json()]\n  const extensionsRes = [json(),oneDark]\n  return {\n    visible,\n    reqCode,\n    resCode,\n    showReqAndRes,\n    handleCancel,\n    extensionsReq,\n    extensionsRes\n  }\n}\n\n// 获取日志\nconst useLogEffect = ()=>{\n  const timeLineList = ref([])\n  const getLogs = async (id)=>{\n    let req = {toolId: id}\n    await getLog(req).then(res=>{\n      if (res.code === 0 && res.data?.testToolRunRecord.length){\n        timeLineList.value = res.data.testToolRunRecord\n      }\n    })\n  }\n  return {\n    timeLineList,getLogs\n  }\n}\n\nexport default {\n  name: \"ToolDetailRecord\",\n  components: {Codemirror},\n  setup() {\n    const { visible, reqCode, resCode, extensionsReq, extensionsRes, showReqAndRes, handleCancel } = useModalEffect()\n    const { timeLineList,getLogs } = useLogEffect()\n    const router = useRouter()\n    getLogs(router.currentRoute.value.params.id)\n    return {\n      timeLineList,visible, reqCode, resCode, extensionsReq, extensionsRes, showReqAndRes, handleCancel\n    }\n  }\n}\n</script>\n\n<style lang=\"less\">\n.tool-detail-record .timeline—group {\n  padding-top: 25px;\n  padding-left: 20px;\n}\n.record-req-left {\n  width: 49%;\n  height: auto;\n  background: #fff;\n  border-right: 1px solid #ededed;\n  min-height: 600px;\n}\n.record-res-right {\n  width: 49%;\n  height: auto;\n  background: #fff;\n  min-height: 600px;\n}\n.full-params-modal {\n  .ant-modal {\n    max-width: 100%;\n    top: 0;\n    padding-bottom: 0;\n    margin: 0;\n  }\n  .ant-modal-content {\n    display: flex;\n    flex-direction: column;\n    height: calc(100vh);\n  }\n  .ant-modal-body {\n    flex: 1;\n  }\n}\n.system-no-content {\n  width: 100%;\n  text-align: center;\n  padding-top: 120px;\n  margin-bottom: 50px;\n  font-size: 15px;\n  min-height: 380px;\n}\n.system-no-content-image {\n  margin: 10px;\n}\n.system-no-content-text {\n  color: #999;\n}\n</style>\n"]}]}